<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FLIPS Rabdan - Daily Security Checklist</title>

<style>
  body {font-family: Arial, sans-serif; padding: 15px; background: #f4f4f4;}
  .title-box {background:#003366; color:white; padding:18px; border-radius:12px; text-align:center; margin-bottom:20px;}
  .title-main {font-size:22px; font-weight:bold;}
  .title-sub-big {font-size:26px; font-weight:bold; margin-top:10px;}
  .title-small {font-size:16px; margin-top:6px; opacity:0.95;}

  h2 {margin-top: 25px; background: #0066cc; color: white; padding: 10px; border-radius: 10px; font-size: 15px; font-weight: 900;}
  .item {background: white; margin: 10px 0; padding: 12px; border-radius: 10px; font-size: 15px; position:relative; padding-left:16px;}
  .item:before{content:""; position:absolute; left:0; top:8px; bottom:8px; width:4px; background:#0066cc; border-radius:8px;}
  select {font-size: 15px; padding: 8px; width: 100%; margin-top:6px; border-radius:10px; box-sizing:border-box;}

  .yes {background:#e9f7ee !important; border:1px solid #a9dfbb;}
  .no  {background:#fdebed !important; border:1px solid #f1a6b0;}
  .na  {background:#f3f3f3 !important; border:1px solid #d5d5d5;}

  .section-box {background:white; padding:12px; border-radius:12px; margin-bottom:15px; border-left:4px solid:#003366;}
  label {font-weight:900; font-size:14px;}
  input[type="text"], input[type="date"], textarea {width:100%; padding:10px; font-size:15px; margin-top:6px; box-sizing:border-box; border-radius:10px; border:1px solid #ddd;}
  textarea {min-height:80px; resize:vertical;}

  #submitBtn {width:100%; padding:14px; font-size:18px; margin-top:14px; border:none; border-radius:12px; background:#007bff; color:white; font-weight:900;}
  #submitBtn:active {opacity:0.85;}
  .note {text-align:center; font-size:12px; margin-top:10px; color:#444;}
</style>
</head>

<body>

<div class="title-box">
  <div class="title-main">Future Leaders International Private School Rabdan Branch</div>
  <div class="title-sub-big">Daily Security Checklist</div>
  <div class="title-small">HSE Section</div>
</div>

<form id="securityForm">

  <div class="section-box">
    <label>Date:</label>
    <input id="checkDate" name="checkDate" type="date" required>
    <br><br>

    <label>Shift:</label>
    <select id="shift" name="shift" required>
      <option value="">Select shift</option>
      <option value="Day">Day</option>
      <option value="Night">Night</option>
    </select>
    <br><br>

    <label>Security Guard Name:</label>
    <input id="securityName" name="securityName" type="text" placeholder="Enter security guard name" required>
    <br><br>

    <label>Remarks / Notes:</label>
    <textarea id="notes" name="notes" placeholder="Enter any incidents, observations, or follow-up actions required"></textarea>
  </div>

  <!-- ✅ KEEP YOUR EXISTING ITEMS EXACTLY LIKE THIS (same as your file) -->
  <h2>Access Control & Gates</h2>
  <div class="item"><div>Gates operational & locks working</div>
    <select class="check-item" data-section="Access Control & Gates" data-question="Gates operational & locks working" required>
      <option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="N/A">N/A</option>
    </select>
  </div>
  <div class="item"><div>Visitor entry logged</div>
    <select class="check-item" data-section="Access Control & Gates" data-question="Visitor entry logged" required>
      <option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="N/A">N/A</option>
    </select>
  </div>
  <div class="item"><div>No unauthorized entry</div>
    <select class="check-item" data-section="Access Control & Gates" data-question="No unauthorized entry" required>
      <option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="N/A">N/A</option>
    </select>
  </div>
  <div class="item"><div>Staircases & elevators securely closed</div>
    <select class="check-item" data-section="Access Control & Gates" data-question="Staircases & elevators securely closed" required>
      <option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="N/A">N/A</option>
    </select>
  </div>

  <h2>CCTV System</h2>
  <div class="item"><div>All cameras functioning</div>
    <select class="check-item" data-section="CCTV System" data-question="All cameras functioning" required>
      <option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="N/A">N/A</option>
    </select>
  </div>
  <div class="item"><div>NVR/DVR active</div>
    <select class="check-item" data-section="CCTV System" data-question="NVR/DVR active" required>
      <option value="">Select</option><option value="Yes">Yes</option><option value="No">No</option><option value="N/A">N/A</option>
    </select>
  </div>

  <!-- ✅ add the rest of your sections/items same pattern (keep class="check-item" + data-section + data-question) -->

  <button id="submitBtn" type="submit">SUBMIT</button>

  <div class="note">After submit, PDF + HTML will be emailed automatically.</div>

</form>

<script>
  // ✅ YOUR WEB APP URL (you gave this)
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzLRyQQ9W9r95wCixpdXRi9nvwDQlwCgbl7yY8J6QY4jKrjSlrdDVGoK9XE7dWKCwig/exec";

  // ✅ Always send to both
  const RECEIVER_EMAILS = "partygifts850@gmail.com,br1-ohs@futureleaders.sch.ae";

  const form = document.getElementById("securityForm");
  const btn = document.getElementById("submitBtn");

  // Color select background
  document.querySelectorAll('.check-item').forEach(sel => {
    sel.addEventListener('change', () => {
      sel.classList.remove('yes','no','na');
      if (sel.value === 'Yes') sel.classList.add('yes');
      else if (sel.value === 'No') sel.classList.add('no');
      else if (sel.value === 'N/A') sel.classList.add('na');
    });
  });

  function collectPayload() {
    const items = [];
    document.querySelectorAll("select.check-item").forEach(sel => {
      items.push({
        section: sel.getAttribute("data-section") || "General",
        question: sel.getAttribute("data-question") || "Question",
        value: (sel.value || "").trim()
      });
    });

    return {
      receiverEmails: RECEIVER_EMAILS,
      checkDate: document.getElementById("checkDate").value || "",
      shift: document.getElementById("shift").value || "",
      securityName: document.getElementById("securityName").value || "",
      notes: document.getElementById("notes").value || "",
      items
    };
  }

  form.addEventListener("submit", async (ev) => {
    ev.preventDefault();

    btn.disabled = true;
    btn.textContent = "SENDING...";

    try {
      const res = await fetch(WEB_APP_URL, {
        method: "POST",
        headers: { "Content-Type": "text/plain;charset=utf-8" },
        body: JSON.stringify(collectPayload())
      });

      const txt = (await res.text()).trim();
      if (txt === "OK") {
        alert("Sent successfully ✅");
        form.reset();
        // reset colors
        document.querySelectorAll('.check-item').forEach(sel => sel.classList.remove('yes','no','na'));
      } else {
        alert("Server replied: " + txt);
      }
    } catch (e) {
      alert("Send failed: " + e);
    } finally {
      btn.disabled = false;
      btn.textContent = "SUBMIT";
    }
  });
</script>

</body>
</html>
