<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="UTF-8">
<title>FLIS Rabdan - Daily Security Checklist</title>

<style>
  body {font-family: Arial, sans-serif; padding: 15px; background: #f4f4f4;}
  .title-box {background:#003366; color:white; padding:18px; border-radius:12px; text-align:center; margin-bottom:20px;}
  .title-main {font-size:22px; font-weight:bold;}
  .title-sub-big {font-size:26px; font-weight:bold; margin-top:10px;}
  .title-small {font-size:16px; margin-top:6px; opacity:0.95;}

  h2 {margin-top: 25px; background: #0066cc; color: white; padding: 10px; border-radius: 6px; font-size: 17px;}
  .item {background: white; margin: 8px 0; padding: 12px; border-radius: 6px; font-size: 16px; border-left: 4px solid #0066cc;}
  select {font-size: 16px; padding: 6px; width: 100%; margin-top:4px; border-radius:6px;}

  .yes {background:#b6f7b1 !important;}
  .no {background:#f7b1b1 !important;}
  .na {background:#ffd699 !important;}

  .section-box {background:white; padding:12px; border-radius:8px; margin-bottom:15px; border-left:4px solid:#003366;}
  label {font-weight:bold;}
  input[type="text"], input[type="date"], textarea {width:100%; padding:8px; font-size:16px; margin-top:4px; box-sizing:border-box;}
  textarea {min-height:80px; resize:vertical;}

  #submitBtn {width:100%; padding:12px; font-size:18px; margin-top:20px; border:none; border-radius:8px; background:#007bff; color:white;}
  #submitBtn:active {opacity:0.8;}

  .note {font-size:13px; color:#555; margin-top:8px; text-align:center;}
</style>
</head>

<body>

<div class="title-box">
  <div class="title-main">Future Leaders International Private School Rabdan Branch</div>
  <div class="title-sub-big">Daily Security Checklist</div>
  <div class="title-small">HSE Section</div>
</div>

<form id="f">

  <div class="section-box">
    <label>Date:</label>
    <input name="date" type="date" required>

    <br><br>
    <label>Shift:</label>
    <select name="shift" required>
      <option value="">Select shift</option>
      <option value="Day">Day</option>
      <option value="Night">Night</option>
    </select>

    <br><br>
    <label>Security Guard Name:</label>
    <input name="securityName" type="text" placeholder="Enter security guard name" required>

    <br><br>
    <label>Remarks / Notes:</label>
    <textarea name="notes" placeholder="Enter any incidents, observations, or follow-up actions required"></textarea>

    <!-- Optional extra receiver (your script can still force fixed receivers) -->
    <input type="hidden" name="receiverEmail" value="">
  </div>

  <script>
    function yn(name){
      return `
        <select class="check-item" name="${name}" required>
          <option value="">Select</option>
          <option value="Yes">Yes</option>
          <option value="No">No</option>
          <option value="N/A">N/A</option>
        </select>
      `;
    }
  </script>

  <h2>Access Control &amp; Gates</h2>
  <div class="item">Gates operational &amp; locks working <span id="ac1"></span></div>
  <div class="item">Visitor entry logged <span id="ac2"></span></div>
  <div class="item">No unauthorized entry <span id="ac3"></span></div>

  <h2>CCTV System</h2>
  <div class="item">All cameras functioning <span id="c1"></span></div>
  <div class="item">NVR/DVR active <span id="c2"></span></div>
  <div class="item">No blind spots <span id="c3"></span></div>
  <div class="item">CCTV control room secure <span id="c4"></span></div>

  <h2>Perimeter &amp; Outdoor Patrol</h2>
  <div class="item">Exterior gates secure <span id="p1"></span></div>
  <div class="item">Parking safe &amp; well-lit <span id="p2"></span></div>
  <div class="item">External exits clear <span id="p3"></span></div>

  <h2>Internal Building Patrol</h2>
  <div class="item">Doors &amp; windows secured <span id="i1"></span></div>
  <div class="item">Emergency exits clear <span id="i2"></span></div>
  <div class="item">Hose reels accessible <span id="i3"></span></div>
  <div class="item">Fire panel status normal <span id="i4"></span></div>
  <div class="item">Restricted rooms secured (Electrical room, Pump room, Server room &amp; Stores) <span id="i5"></span></div>
  <div class="item">Internal / External lights OK <span id="i6"></span></div>

  <h2>Student &amp; Staff Safety</h2>
  <div class="item">Arrival supervised <span id="s1"></span></div>
  <div class="item">Dismissal supervised <span id="s2"></span></div>

  <h2>Environmental &amp; Housekeeping</h2>
  <div class="item">Waste bins OK <span id="e1"></span></div>
  <div class="item">AC/electrical rooms safe <span id="e2"></span></div>
  <div class="item">No chemical hazards <span id="e3"></span></div>
  <div class="item">No water stagnation <span id="e4"></span></div>

  <h2>Emergency Preparedness</h2>
  <div class="item">Extinguishers accessible <span id="ep1"></span></div>
  <div class="item">Assembly signage visible <span id="ep2"></span></div>
  <div class="item">Emergency access clear <span id="ep3"></span></div>

  <div class="note">Reviewed by: OHS Officer Jalil</div>

  <button id="submitBtn" type="submit">SUBMIT</button>
  <div class="note">Submit will send email automatically (PDF + HTML).</div>

</form>

<script>
  // Inject dropdowns (keys)
  document.getElementById("ac1").innerHTML = yn("ac_gatesLocks");
  document.getElementById("ac2").innerHTML = yn("ac_visitorLogged");
  document.getElementById("ac3").innerHTML = yn("ac_noUnauthorized");

  document.getElementById("c1").innerHTML = yn("cctv_allCameras");
  document.getElementById("c2").innerHTML = yn("cctv_nvrDvr");
  document.getElementById("c3").innerHTML = yn("cctv_noBlindSpots");
  document.getElementById("c4").innerHTML = yn("cctv_controlRoomSecure");

  document.getElementById("p1").innerHTML = yn("per_extGates");
  document.getElementById("p2").innerHTML = yn("per_parkingSafe");
  document.getElementById("p3").innerHTML = yn("per_externalExitsClear");

  document.getElementById("i1").innerHTML = yn("int_doorsWindows");
  document.getElementById("i2").innerHTML = yn("int_emergencyExits");
  document.getElementById("i3").innerHTML = yn("int_hoseReels");
  document.getElementById("i4").innerHTML = yn("int_firePanel");
  document.getElementById("i5").innerHTML = yn("int_restrictedRooms");
  document.getElementById("i6").innerHTML = yn("int_lightsOk");

  document.getElementById("s1").innerHTML = yn("ss_arrival");
  document.getElementById("s2").innerHTML = yn("ss_dismissal");

  document.getElementById("e1").innerHTML = yn("eh_wasteBins");
  document.getElementById("e2").innerHTML = yn("eh_acRoomsSafe");
  document.getElementById("e3").innerHTML = yn("eh_noChemical");
  document.getElementById("e4").innerHTML = yn("eh_noStagnation");

  document.getElementById("ep1").innerHTML = yn("ep_extAccessible");
  document.getElementById("ep2").innerHTML = yn("ep_assemblySignage");
  document.getElementById("ep3").innerHTML = yn("ep_emergencyAccess");

  // Color the dropdowns
  document.addEventListener("change", function(e){
    if (!e.target.classList.contains("check-item")) return;
    e.target.classList.remove("yes","no","na");
    if (e.target.value === "Yes") e.target.classList.add("yes");
    if (e.target.value === "No") e.target.classList.add("no");
    if (e.target.value === "N/A") e.target.classList.add("na");
  });

  // âœ… YOUR DEPLOYED WEB APP URL
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwT4ULM7oN_DssX4D4ihq802IWmrVAGynsyUkuMJLk6Ed3MtN-P8r4KYmsaO7yF_fdx/exec";

  document.getElementById("f").addEventListener("submit", async function(ev){
    ev.preventDefault();

    const fd = new FormData(ev.target);
    const data = Object.fromEntries(fd.entries());

    try{
      const res = await fetch(WEB_APP_URL, {
        method: "POST",
        headers: {"Content-Type":"text/plain;charset=utf-8"},
        body: JSON.stringify(data)
      });
      const txt = await res.text();
      if (txt.trim() === "OK") {
        alert("Submitted successfully. Email sent.");
        ev.target.reset();
      } else {
        alert("Error: " + txt);
      }
    } catch(err){
      alert("Submit failed: check deployment access (Anyone) + URL.");
    }
  });
</script>

</body>
</html>
